# hajimu_discord ロードマップ

> hajimu_discord v1.0.0 → discord.js 完全対等を目指す開発計画

---

## 📊 現状の機能カバレッジ（v1.0.0）

### discord.js との機能比較サマリ

| カテゴリ | discord.js | hajimu_discord v1.0.0 | カバー率 |
|---|---|---|---|
| Bot管理 / Gateway | ✅ 完全 | ✅ 基本 | 70% |
| メッセージ送受信 | ✅ 完全 | ✅ 基本 | 50% |
| 埋め込み (Embed) | ✅ 完全 | ✅ 基本 | 75% |
| スラッシュコマンド | ✅ 完全 | ✅ 基本 | 40% |
| リアクション | ✅ 完全 | ⚠️ 一部 | 30% |
| ボタン / セレクトメニュー | ✅ 完全 | ❌ 未実装 | 0% |
| モーダル (Modal) | ✅ 完全 | ❌ 未実装 | 0% |
| スレッド / フォーラム | ✅ 完全 | ❌ 未実装 | 0% |
| ボイスチャンネル | ✅ (@discordjs/voice) | ❌ 未実装 | 0% |
| Webhook | ✅ 完全 | ❌ 未実装 | 0% |
| 監査ログ (Audit Log) | ✅ 完全 | ❌ 未実装 | 0% |
| AutoModeration | ✅ 完全 | ❌ 未実装 | 0% |
| スケジュールイベント | ✅ 完全 | ❌ 未実装 | 0% |
| 権限管理 | ✅ 完全 | ❌ 未実装 | 0% |
| 招待 (Invite) | ✅ 完全 | ❌ 未実装 | 0% |
| 絵文字 / スタンプ管理 | ✅ 完全 | ❌ 未実装 | 0% |
| チャンネル管理 (CRUD) | ✅ 完全 | ❌ 未実装 | 0% |
| シャーディング | ✅ 完全 | ❌ 未実装 | 0% |
| キャッシュ / コレクション | ✅ 完全 | ❌ 未実装 | 0% |
| ファイル添付 | ✅ 完全 | ❌ 未実装 | 0% |
| 投票 (Poll) | ✅ 完全 | ❌ 未実装 | 0% |
| エラーハンドリング | ✅ 完全 | ⚠️ 基本 | 25% |
| レート制限管理 | ✅ 完全 | ⚠️ 基本リトライ | 30% |

**全体カバレッジ: 約 15%**（55関数 / discord.js 300+クラス・関数）

---

## 🔴 v1.0.0 で不足している主要機能

### 1. メッセージコンポーネント（最重要）

discord.js では Bot のインタラクションの中核を担う機能群。

| 機能 | discord.js クラス | 優先度 |
|---|---|---|
| ボタン | `ButtonBuilder`, `ActionRowBuilder` | 🔴 最高 |
| セレクトメニュー（文字列） | `StringSelectMenuBuilder` | 🔴 最高 |
| セレクトメニュー（ユーザー） | `UserSelectMenuBuilder` | 🟡 高 |
| セレクトメニュー（ロール） | `RoleSelectMenuBuilder` | 🟡 高 |
| セレクトメニュー（チャンネル） | `ChannelSelectMenuBuilder` | 🟡 高 |
| セレクトメニュー（メンション可能） | `MentionableSelectMenuBuilder` | 🟡 高 |
| モーダル / テキスト入力 | `ModalBuilder`, `TextInputBuilder` | 🔴 最高 |
| コンポーネント V2 | `ContainerBuilder`, `SectionBuilder`, `SeparatorBuilder` | 🔵 低 |

### 2. メッセージ機能の拡張

| 機能 | discord.js | 優先度 |
|---|---|---|
| メッセージ編集 | `Message.edit()` | 🔴 最高 |
| メッセージ削除 | `Message.delete()` | 🔴 最高 |
| メッセージ一括削除 | `TextChannel.bulkDelete()` | 🟡 高 |
| メッセージピン | `Message.pin()` / `unpin()` | 🟡 高 |
| ファイル添付送信 | `AttachmentBuilder` | 🟡 高 |
| メッセージ取得（履歴） | `TextChannel.messages.fetch()` | 🟡 高 |
| リプライ（参照付き） | `Message.reply()` with reference | 🔴 最高 |
| メンション制御 | `AllowedMentionsBuilder` | 🟡 高 |

### 3. スラッシュコマンドの拡充

| 機能 | discord.js | 優先度 |
|---|---|---|
| サブコマンド | `ChatInputCommandSubcommandBuilder` | 🔴 最高 |
| サブコマンドグループ | `ChatInputCommandSubcommandGroupBuilder` | 🟡 高 |
| オートコンプリート | `AutocompleteInteraction` | 🟡 高 |
| コンテキストメニュー（右クリック） | `ContextMenuCommandBuilder` | 🟡 高 |
| コマンド権限 | `ApplicationCommandPermissionsManager` | 🟡 高 |
| 遅延応答の完全サポート | Deferred reply + followup | 🔴 最高 |
| エフェメラル応答 | Ephemeral messages | 🔴 最高 |

### 4. チャンネル管理

| 機能 | discord.js | 優先度 |
|---|---|---|
| チャンネル作成 | `GuildChannelManager.create()` | 🟡 高 |
| チャンネル編集 | `GuildChannel.edit()` | 🟡 高 |
| チャンネル削除 | `GuildChannel.delete()` | 🟡 高 |
| カテゴリ管理 | `CategoryChannel` | 🟡 高 |
| 権限オーバーライド | `PermissionOverwriteManager` | 🟡 高 |
| スレッド作成 / 管理 | `ThreadManager`, `ThreadChannel` | 🟡 高 |
| フォーラムチャンネル | `ForumChannel`, `GuildForumThreadManager` | 🔵 中 |

### 5. ボイスチャンネル

| 機能 | discord.js | 優先度 |
|---|---|---|
| VC接続 | `@discordjs/voice` JoinVoiceChannel | 🔵 中 |
| 音声再生 | AudioPlayer, AudioResource | 🔵 中 |
| 音声受信 | VoiceReceiver | 🔵 低 |
| ステージチャンネル | `StageChannel`, `StageInstanceManager` | 🔵 低 |

### 6. サーバー管理の拡張

| 機能 | discord.js | 優先度 |
|---|---|---|
| サーバー編集 | `Guild.edit()` | 🔵 中 |
| 絵文字管理 (CRUD) | `GuildEmojiManager` | 🔵 中 |
| スタンプ管理 | `GuildStickerManager` | 🔵 低 |
| サウンドボード | `GuildSoundboardSoundManager` | 🔵 低 |
| 招待管理 | `GuildInviteManager` | 🟡 高 |
| テンプレート | `GuildTemplate` | 🔵 低 |
| ウェルカム画面 | `WelcomeScreen` | 🔵 中 |
| オンボーディング | `GuildOnboarding` | 🔵 低 |

### 7. モデレーション / セキュリティ

| 機能 | discord.js | 優先度 |
|---|---|---|
| タイムアウト（通信無効化） | `GuildMember.timeout()` | 🔴 最高 |
| 監査ログ | `GuildAuditLogs` | 🟡 高 |
| AutoModeration ルール | `AutoModerationRule`, `AutoModerationRuleManager` | 🟡 高 |
| メッセージ一括削除 | Bulk Delete API | 🟡 高 |

### 8. Webhook

| 機能 | discord.js | 優先度 |
|---|---|---|
| Webhook 作成 | `TextChannel.createWebhook()` | 🟡 高 |
| Webhook 送信 | `Webhook.send()` | 🟡 高 |
| Webhook 編集 / 削除 | `Webhook.edit()` / `delete()` | 🔵 中 |

### 9. スケジュールイベント

| 機能 | discord.js | 優先度 |
|---|---|---|
| イベント作成 | `GuildScheduledEventManager.create()` | 🔵 中 |
| イベント編集 / 削除 | `edit()` / `delete()` | 🔵 中 |
| 参加者管理 | `fetchSubscribers()` | 🔵 低 |

### 10. 投票 (Poll)

| 機能 | discord.js | 優先度 |
|---|---|---|
| 投票作成 | `PollBuilder` | 🔵 中 |
| 投票結果取得 | `Poll.answers` / `fetchVoters()` | 🔵 中 |

### 11. インフラ / アーキテクチャ

| 機能 | discord.js | 優先度 |
|---|---|---|
| シャーディング | `ShardingManager` | 🔵 中 |
| キャッシュシステム | `Collection`, managers with cache | 🟡 高 |
| イベントコレクター | `MessageCollector`, `ReactionCollector`, `InteractionCollector` | 🔴 最高 |
| 完全なレート制限管理 | Per-route rate limit, bucket system | 🟡 高 |
| 詳細なエラーハンドリング | `DiscordAPIError`, typed errors | 🟡 高 |
| Partial オブジェクト | Partial message/reaction/channel support | 🔵 中 |

---

## 📅 リリースロードマップ

### v1.1.0 — メッセージ操作の完全化（2026年2月実装済）

**テーマ: 基本操作の強化**

- [x] メッセージ編集 `ボット.メッセージ編集(チャンネルID, メッセージID, 新しい内容)`
- [x] メッセージ削除 `ボット.メッセージ削除(チャンネルID, メッセージID)`
- [x] メッセージ一括削除 `ボット.メッセージ一括削除(チャンネルID, 件数)`
- [x] メッセージ取得 `ボット.メッセージ取得(チャンネルID, メッセージID)`
- [x] メッセージ履歴 `ボット.メッセージ履歴(チャンネルID, 件数)`
- [x] メッセージピン / ピン解除 `ボット.ピン(チャンネルID, メッセージID)`
- [x] リプライ（参照付き） `ボット.リプライ(メッセージ, 内容)`
- [x] リアクション削除 `ボット.リアクション削除(チャンネルID, メッセージID, 絵文字)`
- [x] リアクション全削除 `ボット.リアクション全削除(チャンネルID, メッセージID)`
- [x] タイムアウト `ボット.タイムアウト(サーバーID, ユーザーID, 秒数)`
- [x] エラーイベント `ボット.エラー時(関数(エラー): ... 終わり)`
- [x] 切断イベント `ボット.切断時(関数(): ... 終わり)`

**新規関数: +12** ✅

---

### v1.2.0 — メッセージコンポーネント（2026年2月実装済）

**テーマ: インタラクティブ UI**

- [x] ボタン作成 `ボット.ボタン作成(ラベル, スタイル, カスタムID)`
- [x] ボタン行作成 `ボット.アクション行作成()`
- [x] ボタン行にボタン追加 `ボット.行にボタン追加(行, ボタン)`
- [x] コンポーネント付きメッセージ送信 `ボット.コンポーネント送信(チャンネルID, テキスト, 行配列)`
- [x] ボタンクリック時イベント `ボット.ボタン時(カスタムID, 関数(インタラクション): ... 終わり)`
- [x] セレクトメニュー作成 `ボット.セレクトメニュー作成(カスタムID, プレースホルダー)`
- [x] セレクトメニュー選択肢追加 `ボット.メニュー選択肢(メニュー, ラベル, 値, 説明)`
- [x] セレクトメニュー選択時イベント `ボット.セレクト時(カスタムID, 関数(インタラクション): ... 終わり)`
- [x] インタラクション更新 `ボット.インタラクション更新(インタラクション, 内容)`
- [x] エフェメラル応答 `ボット.コマンド応答(インタラクション, 内容, 真)`（第3引数=エフェメラル）
- [x] 遅延応答 `ボット.コマンド遅延応答(インタラクション)`
- [x] フォローアップ `ボット.コマンドフォローアップ(インタラクション, 内容)`

**新規関数: +13 | 累計: ~80** ✅

---

### v1.3.0 — モーダル & 高度なコマンド（2026年2月実装済）

**テーマ: フォームとコマンド構造の充実**

- [x] モーダル作成 `ボット.モーダル作成(カスタムID, タイトル)`
- [x] テキスト入力追加 `ボット.テキスト入力追加(モーダル, ラベル, カスタムID, スタイル)`
- [x] モーダル表示 `ボット.モーダル表示(インタラクション, モーダル)`
- [x] モーダル送信時イベント `ボット.モーダル送信時(カスタムID, 関数(インタラクション): ... 終わり)`
- [x] サブコマンド登録 `ボット.サブコマンド追加(コマンド名, サブ名, 説明, 関数)`
- [x] サブコマンドグループ `ボット.サブコマンドグループ追加(コマンド名, グループ名, 説明)`
- [x] オートコンプリート `ボット.オートコンプリート時(コマンド名, 関数(インタラクション): ... 終わり)`
- [x] コンテキストメニュー（ユーザー） `ボット.ユーザーメニュー登録(名前, 関数)`
- [x] コンテキストメニュー（メッセージ） `ボット.メッセージメニュー登録(名前, 関数)`
- [x] コマンドオプション: 選択肢 `ボット.コマンド選択肢(オプション, 名前, 値)`

**新規関数: +11 | 累計: ~89** ✅

---

### v1.4.0 — チャンネル & スレッド管理（2026年2月実装済）

**テーマ: サーバー構造操作**

- [x] チャンネル作成 `ボット.チャンネル作成(サーバーID, 名前, 種類)`
- [x] チャンネル編集 `ボット.チャンネル編集(チャンネルID, 設定)`
- [x] チャンネル削除 `ボット.チャンネル削除(チャンネルID)`
- [x] チャンネル一覧 `ボット.チャンネル一覧(サーバーID)`
- [x] スレッド作成 `ボット.スレッド作成(チャンネルID, 名前, 自動アーカイブ時間)`
- [x] スレッド参加 / 退出 `ボット.スレッド参加(スレッドID)`
- [x] スレッドメンバー管理 `ボット.スレッドメンバー追加(スレッドID, ユーザーID)`
- [x] 権限オーバーライド設定 `ボット.権限設定(チャンネルID, 対象ID, 許可, 拒否)`
- [x] 招待作成 `ボット.招待作成(チャンネルID, 設定)`
- [x] 招待一覧 `ボット.招待一覧(サーバーID)`

**新規関数: +13 | 累計: ~97** ✅

---

### v1.5.0 — Webhook & ファイル添付（2026年2月実装済）

**テーマ: 外部連携と添付ファイル**

- [x] Webhook 作成 `ボット.Webhook作成(チャンネルID, 名前)`
- [x] Webhook 送信 `ボット.Webhook送信(WebhookURL, 内容)`
- [x] Webhook 送信（カスタム名・アバター） `ボット.Webhook送信(URL, 内容, 名前, アバターURL)`
- [x] Webhook 削除 `ボット.Webhook削除(WebhookID)`
- [x] ファイル添付送信 `ボット.ファイル送信(チャンネルID, ファイルパス, コメント)`
- [x] Webhook一覧 `ボット.Webhook一覧(チャンネルID)`
- [x] 埋め込み画像（URL指定） `ボット.埋め込み画像(埋め込み, URL)` — v1.0で実装済
- [x] 埋め込みサムネイル `ボット.埋め込みサムネイル(埋め込み, URL)` — v1.0で実装済

**新規関数: +5 | 累計: ~102** ✅

---

### v1.6.0 — コレクター & キャッシュ（2026年2月実装済）

**テーマ: イベント駆動の高度なパターン**

- [x] メッセージコレクター `ボット.メッセージ収集(チャンネルID, フィルタ, タイムアウト)`
- [x] リアクションコレクター `ボット.リアクション収集(メッセージ, フィルタ, タイムアウト)`
- [x] インタラクションコレクター `ボット.インタラクション収集(メッセージ, フィルタ, タイムアウト)`
- [x] メンバー一覧取得 `ボット.メンバー一覧(サーバーID)`
- [x] メンバー検索 `ボット.メンバー検索(サーバーID, クエリ)`
- [x] サーバー一覧 `ボット.サーバー一覧()`
- [ ] 完全なレート制限管理（バケットシステム）

**新規関数: +6 | 累計: ~108** ✅

---

### v1.7.0 — 監査ログ & AutoModeration（2026年2月実装済）

**テーマ: モデレーション強化**

- [x] 監査ログ取得 `ボット.監査ログ(サーバーID, 種類, 件数)`
- [x] AutoMod ルール作成 `ボット.AutoModルール作成(サーバーID, 設定)`
- [x] AutoMod ルール編集 / 削除
- [x] AutoMod イベント `ボット.AutoMod実行時(関数(データ): ... 終わり)`
- [x] 絵文字一覧 `ボット.絵文字一覧(サーバーID)`
- [x] 絵文字作成 `ボット.絵文字作成(サーバーID, 名前, 画像パス)`
- [x] 絵文字削除 `ボット.絵文字削除(サーバーID, 絵文字ID)`
- [x] スケジュールイベント作成 `ボット.イベント作成(サーバーID, 名前, 開始, 終了, 説明)`
- [x] スケジュールイベント編集 / 削除
- [x] 投票作成 `ボット.投票作成(チャンネルID, 質問, 選択肢配列, 時間)`
- [x] 投票終了 `ボット.投票終了(チャンネルID, メッセージID)`
- [x] AutoModルール一覧 / 取得
- [x] イベント一覧 `ボット.イベント一覧(サーバーID)`

**新規関数: +16 | 累計: ~124** ✅

---

### v2.0.0 — ボイスチャンネル対応（2026年2月実装済）

**テーマ: ボイスチャンネル音声再生**

- [x] VC接続 `ボット.VC接続(サーバーID, チャンネルID)`
- [x] VC切断 `ボット.VC切断(サーバーID)`
- [x] 音声再生（ファイル） `ボット.音声再生(サーバーID, ソース)` — WAV/MP3/OGG等対応（ffmpeg連携）
- [x] 音声停止 `ボット.音声停止(サーバーID)`
- [x] 音声一時停止 `ボット.音声一時停止(サーバーID)`
- [x] 音声再開 `ボット.音声再開(サーバーID)`
- [x] 音声スキップ `ボット.音声スキップ(サーバーID)`
- [x] 音声キュー管理 `ボット.音声キュー(サーバーID)`
- [x] 音声ループ `ボット.音声ループ(サーバーID, 有効)`
- [x] VC状態取得 `ボット.VC状態(サーバーID)`
- [x] 音声音量 `ボット.音声音量(サーバーID, 音量)`
- [x] Voice Gateway WebSocket (v4)
- [x] UDP RTP + AEAD XChaCha20-Poly1305 暗号化 (rtpsize)
- [x] Opus エンコーダー (48kHz, ステレオ, 20ms)
- [x] IP Discovery 自動検出
- [x] ステージチャンネル管理 → v2.1.0で実装
- [ ] シャーディング対応（v2.2.0以降へ延期）

**新規関数: +11 | 累計: ~138** ✅

---

### v2.1.0 — ステージチャンネル・スタンプ・ユーティリティ拡張（2026-02-15）

**テーマ: ステージ・スタンプ・フォーラム・Markdownユーティリティ**

- [x] ステージ開始 `ボット.ステージ開始(チャンネルID, トピック[, 公開])`
- [x] ステージ編集 `ボット.ステージ編集(チャンネルID, トピック)`
- [x] ステージ終了 `ボット.ステージ終了(チャンネルID)`
- [x] ステージ情報 `ボット.ステージ情報(チャンネルID)`
- [x] スタンプ一覧 `ボット.スタンプ一覧(サーバーID)`
- [x] スタンプ取得 `ボット.スタンプ取得(サーバーID, スタンプID)`
- [x] スタンプ作成 `ボット.スタンプ作成(サーバーID, 名前, ファイルパス[, 説明, タグ])`
- [x] スタンプ編集 `ボット.スタンプ編集(サーバーID, スタンプID, 設定)`
- [x] スタンプ削除 `ボット.スタンプ削除(サーバーID, スタンプID)`
- [x] ウェルカム画面取得 `ボット.ウェルカム画面取得(サーバーID)`
- [x] ウェルカム画面編集 `ボット.ウェルカム画面編集(サーバーID, 設定)`
- [x] サーバー編集 `ボット.サーバー編集(サーバーID, 設定)`
- [x] ロール作成 `ボット.ロール作成(サーバーID, 名前[, 色, 権限])`
- [x] ロール編集 `ボット.ロール編集(サーバーID, ロールID, 設定)`
- [x] ロール削除 `ボット.ロール削除(サーバーID, ロールID)`
- [x] フォーラム投稿 `ボット.フォーラム投稿(チャンネルID, タイトル, 内容[, タグ])`
- [x] フォーラムタグ一覧 `ボット.フォーラムタグ一覧(チャンネルID)`
- [x] 太字 / 斜体 / 下線 / 取り消し線 / コード / コードブロック / 引用 / スポイラー
- [x] ユーザーメンション / チャンネルメンション / ロールメンション
- [x] タイムスタンプ / カスタム絵文字 / リンク / 見出し / リスト

**新規関数: +33 | 累計: 171** ✅

---

### v2.2.0+ — 完全対等を目指して（2026-02-14）

**テーマ: Components V2・テンプレート・サウンドボード・OAuth2・シャーディング**

- [x] Components V2: テキスト表示 / セパレーター / メディアギャラリー / メディアアイテム / サムネイル / セクション / コンテナ / ファイル / V2メッセージ送信
- [x] サーバーテンプレート: 一覧 / 取得 / 作成 / 同期 / 編集 / 削除 / テンプレートからサーバー作成
- [x] オンボーディング: 取得 / 設定
- [x] サウンドボード: 一覧 / 取得 / 作成 / 編集 / 削除 / 再生 / デフォルト一覧
- [x] ロール接続メタデータ: メタデータ取得・設定 / ユーザー接続取得・更新
- [x] エンタイトルメント / SKU: SKU一覧 / エンタイトルメント一覧・消費 / テスト作成・削除
- [x] OAuth2: トークン交換 / リフレッシュ / 無効化 / 自分情報 / 認可URL生成
- [x] シャーディング: シャード設定 / シャード情報 / シャードID計算
- [x] Gateway IDENTIFY にシャードフィールド自動付与

**新規関数: +42 | 累計: 213** ✅

---

### v2.3.0 — discord.js/discord.py 完全互換（2026-02-14）

**テーマ: 不足機能の総仕上げ — 自動選択メニュー・BAN管理・サーバー管理拡充・Gateway全カバー**

- [x] 自動選択メニュー: ユーザーセレクト / ロールセレクト / チャンネルセレクト / メンション可能セレクト
- [x] BAN管理拡張: BAN一覧 / BAN一括
- [x] メンバー管理拡張: メンバー編集 / ニックネーム変更
- [x] Webhook拡張: Webhook編集 / Webhook情報 / Webhookメッセージ編集 / Webhookメッセージ削除
- [x] スレッド管理拡張: アクティブスレッド一覧 / アーカイブスレッド一覧 / スレッドアーカイブ / スレッドロック / スレッドピン
- [x] アナウンスチャンネル: クロスポスト / チャンネルフォロー
- [x] サーバー管理拡張: プルーン確認 / プルーン実行 / サーバー削除 / サーバープレビュー / ウィジェット設定取得 / ウィジェット設定更新 / バニティURL取得
- [x] チャンネル / ロール位置変更
- [x] リアクション拡張: リアクションユーザー一覧 / 絵文字リアクション削除
- [x] コマンド管理: コマンド一覧 / コマンド削除 / コマンド権限設定
- [x] ユーティリティ: Snowflakeタイムスタンプ / 権限値 / 権限チェック / アプリ情報 / Voice地域一覧 / ステッカーパック一覧
- [x] Gatewayイベント: 40+種の日本語対応（CHANNEL_UPDATE, GUILD_BAN_*, GUILD_ROLE_*, GUILD_MEMBER_UPDATE, THREAD_*, INVITE_*, MESSAGE_DELETE_BULK, STAGE_INSTANCE_*, POLL_VOTE_*, ENTITLEMENT_*, AUTO_MODERATION_RULE_* 等）

**新規関数: +39 | 累計: 252** ✅

---

### v2.5.0 — yt-dlp Cookie対応 + バグ修正（2026-02-15 実装済）

**テーマ: YouTube再生の安定化**

- [x] yt-dlp Cookie自動検出 (`cookies.txt` / `--cookies-from-browser`)
- [x] `偶`→`偽` 真偽値バグ修正（6箇所）
- [x] バッファオーバーフロー修正 (`ep[256]`→`ep[512]`)
- [x] Voice State キャッシュ改善
- [x] music_bot.jp: オプションアクセス修正、遅延応答+フォローアップパターン

---

### v2.6.0 — ボイス音声品質・安定性の大幅改善（2026-02-15 実装済）

**テーマ: 音楽Bot実用化・Discord最新仕様対応**

- [x] AEAD暗号化移行: `xsalsa20_poly1305` → `aead_xchacha20_poly1305_rtpsize`
- [x] 非同期コールバック: スラッシュコマンドを非同期スレッドで実行（Gatewayブロック解消）
- [x] 音声品質向上: Opusビットレート128kbps、絶対時間ベースフレームスケジューリング
- [x] VC切断デッドロック修正: `voice_free()` スレッドjoin順序修正・SSL解放競合解消
- [x] IP Discovery改善: リトライロジック（3回）、大容量バッファ（256byte）
- [x] Voice WSポート動的抽出: Discordエンドポイントからポート番号を自動解析
- [x] YouTube URL対応改善: `&` 等のURL文字を許可（filepath安全性チェック）
- [x] サイレンスフレーム暗号化: AEAD XChaCha20-Poly1305に統一
- [x] yt-dlp stderr ログ保存 (`/tmp/hajimu_ytdlp_err.log`)

---

## 🏁 全マイルストーン達成！

---

## 🎯 マイルストーン目標

| バージョン | 関数数 | カバレッジ | 目標 |
|---|---|---|---|
| **v1.0.0** | 55 | ~15% | 基本的なBot構築 |
| **v1.2.0** | ~79 | ~35% | インタラクティブBot |
| **v1.5.0** | ~106 | ~55% | 実用的な中規模Bot |
| **v1.7.0** | ~123 | ~70% | モデレーションBot完全対応 |
| **v2.0.0** | ~138 | ~80% | 音楽Bot・大規模対応 |
| **v2.1.0** | 171 | ~90% | ステージ・スタンプ・ユーティリティ |
| **v2.2.0** | 213 | ~97% | discord.js 完全対等 |
| **v2.3.0** | **252** | **~99%** | discord.js/discord.py 完全互換 |
| **v2.5.0** | **252** | **~99%** | yt-dlp Cookie対応 + バグ修正 |
| **v2.6.0** (現在) | **252** | **~99%** | ボイス品質・安定性大幅改善 |

---

## 📋 優先度の定義

| 記号 | 意味 | 基準 |
|---|---|---|
| 🔴 最高 | 次のリリースで必須 | discord.js の基本的な Bot で99%使う機能 |
| 🟡 高 | 近いうちに実装 | 中規模以上の Bot で頻繁に使う機能 |
| 🔵 中〜低 | 将来実装 | 特定ユースケースや大規模Bot向け |

---

## 💡 設計方針

1. **完全日本語API** — すべての関数名・引数名・イベント名を日本語で統一
2. **discord.js との概念対応** — discord.js ユーザーが移行しやすい API 設計
3. **シンプル重視** — discord.js のマネージャーパターンではなく、フラットな関数呼び出し
4. **段階的リリース** — 各バージョンで実用的なBotが1つ増える程度の機能追加
5. **後方互換性** — v1.x 内では既存APIを破壊しない

---

## 🔗 関連リンク

- [hajimu_discord リポジトリ](https://github.com/ReoShiozawa/hajimu_discord)
- [はじむ言語 リポジトリ](https://github.com/ReoShiozawa/hajimu)  
- [Discord API ドキュメント](https://discord.com/developers/docs)
- [discord.js ドキュメント](https://discord.js.org/)

---

*最終更新: 2026年2月15日 (v2.6.0)*
